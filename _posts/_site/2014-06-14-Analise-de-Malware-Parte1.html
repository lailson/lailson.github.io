<p>Este post mostra uma introdução à Análise de Malware mostrando passo-a-passo como devemos analisar de forma estática e dinâmica um malware. 
A análise </p>

<h1 id="analisando-malware">Analisando Malware</h1>

<h2 id="anlise-na-web">Análise na web</h2>
<p>Inicialmente vamos submentar o nosso artefato a um site para ser avalisado por diersos antivirus. O site é <a href="http://virustotal.com">www.virustotal.com</a></p>
<figure>
 	<img src="/images/virustotal.png" />
 </figure>

<p>Nesse caso o malware submetido pof analisado por 54 antivirus no qual 40 deles detectaram que este realmente é um malware.</p>

<h2 id="ambiente-virtual">Ambiente Virtual</h2>
<p>Nessa prática vamos utilizar o <a href="https://www.virtualbox.org/">Virtual Box</a> que é uma ferramentar para virtualizar ambientes, assim podemos simular (virtualizar) uma máquina windows xp e uma máquina linux (REMnux). 
Como vamos manipular um malware devemos tomar certos cuidados, para isso vamos criar uma rede host-only para que haja conexão apenas entre a máquina windows XP e Linux. 
Para faciliar segue o <a href="#">link da máquina xp</a> no formato .ova e do <a href="http://sourceforge.net/projects/remnux/files/version5/remnux-5.0-live-cd.iso/download"> linux no formato iso e <a href="http://sourceforge.net/projects/remnux/files/version5/remnux-5.0-ova-public.ova/download">no formato ova</a></a></p>
<figure>
 	<img src="/images/analisemalware/virtualbox.png" />
 </figure>

<h2 id="anlise-esttica---cdigo">Análise Estática - Código</h2>
<p>Vamos analisar o código utilizando um programa bintext <a href="http://b2b-download.mcafee.com/products/tools/foundstone/bintext303.zip">link</a> que é possível “ler” um código mesmo depois que o arquivo é compilado.</p>
<figure>
 	<img src="/images/analisemalware/bintext.png" />
 </figure>
<p>Como mostra a figura a cima o código está ofuscado. Essa é uma técnica usada pelos malwares para tentar esconder seu código, para isso é utilizado programas conhecidos como packer. Pare tentar desofuscar o código iremos utilizao o UPX <a href="http://sourceforge.net/projects/upx/">link</a></p>
<figure>
 	<img src="/images/analisemalware/upx.png" />
 </figure>
<p>Figura: upx </p>

<h2 id="anlise-dinmica---comportamental">Análise Dinâmica - Comportamental</h2>
<p>Utilizaremos o wireshark para verificar os pacotes que trafegam na rede. O wireshark é um snifer (bisbilhoteiro) que capture o tráfego da rede para análise.
Neste caso usaremos a versão do Remnux que ja vem com o wireshark instalado, mas primiero devemos criar uma rede host-only.
Para execute o wireshark pelo remnux utiliza-se o comando <code>sudo wireshark</code> e a senha do root é <code>malware</code></p>
<figure>
 	<img src="/images/analisemalware/wireshark.png" />
 </figure>

<h3 id="hosts">Hosts</h3>
<p>Na nossa experiência percebemos através do wireshark que nosso malware tenta se conectar com o servidor lailsonhenrique.com então vamos alterar o arquivo hosts para que o windowsxp pense que nossa máquina linux é o servidor lailsonhenrique.com
<code>C:\windows\system32\drivers\etc\hosts</code></p>
<figure>
 	<img src="/images/analisemalware/hosts.png" />
 </figure>
<p>Figura: Aterando arquivo Hosts</p>

<h2 id="irc">IRC</h2>
<p>O malware tenta se conectar a um servidor irc, sendo assim vamos utilizar o Remnux para estartar um servidor irc utilizando o comando <code>ircd start</code> depois vamos entrar no canal <code>#malware</code> e vamos perceber que o virus estar conectado a este canal, então vamos digitar alguns comandos para interagir com o malware
É necessário se autenticar para se comunicar com o malware para isso vamos digitar <code>.login aula</code> onde aula é a senha.</p>

<h1 id="vdeo">Vídeo</h1>
<p>Veja todo o processo no vídeo a baixo</p>

<iframe width="420" height="315" src="https://www.youtube.com/watch?v=8MEjb4N5kTM" frameborder="0" allowfullscreen=""></iframe>

